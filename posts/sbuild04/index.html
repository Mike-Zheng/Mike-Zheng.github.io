<!DOCTYPE html><html lang="zh-Hant-TW"><head><link rel="manifest" href="/manifest.json"><link rel="manifest" href="/manifest.json"><meta charset="UTF-8"><title>[作品筆記] sketch-builder 雲端原型工具開發筆記(04) - 功能開發 | Mike前端工程師筆記</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=3,minimum-scale=1"><meta name="author" content="mikeZheng"><meta name="description" content="功能開發這次主題主要是開發原型設計工具，並參考sketch作為主要臨摹對象，在上篇 “(03)開發的目標與介面設計” 已經提到相關UI的設計將會使用印度設計師的作品之後，這一篇要開始嚕一個原型工具出來。先簡單列點需要開發的大項目，會再針對各項目進行簡單的探究。更深入的邏輯有興趣的話當然可以pm我本人，不過核心的資料結構操作如果有機會，我是更想要能夠貢獻於目前任職的工作開發項目上面，因此只會列點提示"><meta name="keywords" content="專案"><meta property="og:type" content="article"><meta property="og:title" content="[作品筆記] sketch-builder 雲端原型工具開發筆記(04)  - 功能開發"><meta property="og:url" content="https://mike-zheng.github.io/posts/sbuild04/index.html"><meta property="og:site_name" content="Mike前端工程師筆記"><meta property="og:description" content="功能開發這次主題主要是開發原型設計工具，並參考sketch作為主要臨摹對象，在上篇 “(03)開發的目標與介面設計” 已經提到相關UI的設計將會使用印度設計師的作品之後，這一篇要開始嚕一個原型工具出來。先簡單列點需要開發的大項目，會再針對各項目進行簡單的探究。更深入的邏輯有興趣的話當然可以pm我本人，不過核心的資料結構操作如果有機會，我是更想要能夠貢獻於目前任職的工作開發項目上面，因此只會列點提示"><meta property="og:locale" content="zh-Hant-TW"><meta property="og:image" content="https://mike-zheng.github.io/images/thumbnail.png"><meta property="og:updated_time" content="2022-02-26T14:24:36.931Z"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://mike-zheng.github.io/images/thumbnail.png"><link rel="icon" href="/images/LOGO_192x192.png"><link rel="apple-touch-icon" href="/images/LOGO_144x144.png"><link rel="apple-touch-icon-precomposed" href="/images/LOGO_144x144.png"><meta name="apple-mobile-web-app-capable" content="yes"><link href="/images/apple_splash_750.jpg" sizes="750x1334" rel="apple-touch-startup-image"><script deffer>// Detects if device is on iOS 
const isIos = () => {
  const userAgent = window.navigator.userAgent.toLowerCase();
  return /iphone|ipad|ipod/.test( userAgent );
}
// Detects if device is in standalone mode
const isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone);

// Checks if should display install popup notification:
if (isIos() && !isInStandaloneMode()) {
  this.setState({ showInstallMessage: true });
}</script><!--[if lt IE 9]>
    <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]--><link rel="stylesheet" href="/css/mizUI.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/zclip/1.1.2/jquery.zclip.min.js"></script><link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css"><script src="//cdn.bootcss.com/highlight.js/9.6.0/highlight.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-71903354-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-71903354-1")</script><link rel="stylesheet" href="/css/prism-vsc-dark-plus.css" type="text/css"></head><body><header><div class="header-container"><div id="imglogo" class="site-logo"><a href="/"><img src="/images/LOGO_192x192.png" alt="Mike前端工程師筆記" title="Mike前端工程師筆記"></a></div><div id="textlogo" class="site-name"><div class="site-title"><a href="/" title="Mike前端工程師筆記">前端工程師筆記</a></div></div><div class="nav-container"><div class="nav-head"><nav class="miz-nav"><div class="search-wrapper"><form class="site-search-form"><input type="text" id="local-search-input" class="nav-search st-search-input" autocomplete="off" placeholder="ctrl + `"></form><div id="local-search-result" class="local-search-result-cls"></div></div><ul><li><a href="/">首頁</a></li><li class="active"><a href="/archives">文章</a></li><li><a href="https://www.facebook.com/liwenzheng.mike" target="_blank" rel="noopener">臉書</a></li><li><a href="https://github.com/Mike-Zheng" target="_blank" rel="noopener">Page</a></li><li><div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div></li></ul></nav></div><div id="nav-rwd" class="nav-rwd"><i class="fa fa-bars" aria-hidden="true"></i></div></div></div></header><nav id="mobile-nav" class="mobile-nav"><div id="toc" class="toc-aside"><strong class="toc-title">Contents</strong><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#功能開發"><span class="toc-number">1.</span> <span class="toc-text">功能開發</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#需開發的項目"><span class="toc-number">1.1.</span> <span class="toc-text">需開發的項目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#畫布功能"><span class="toc-number">1.2.</span> <span class="toc-text">畫布功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-群組化"><span class="toc-number">1.2.1.</span> <span class="toc-text">1. 群組化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-多選"><span class="toc-number">1.2.2.</span> <span class="toc-text">2. 多選</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-對齊線"><span class="toc-number">1.2.3.</span> <span class="toc-text">3. 對齊線</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-尺規行為"><span class="toc-number">1.2.4.</span> <span class="toc-text">4. 尺規行為</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-縮放"><span class="toc-number">1.2.5.</span> <span class="toc-text">5. 縮放</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-context-menu"><span class="toc-number">1.2.6.</span> <span class="toc-text">6. context menu</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#圖層"><span class="toc-number">1.3.</span> <span class="toc-text">圖層</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#元件"><span class="toc-number">1.4.</span> <span class="toc-text">元件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#export畫布"><span class="toc-number">1.5.</span> <span class="toc-text">export畫布</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Keyboard-Shortcuts"><span class="toc-number">1.6.</span> <span class="toc-text">Keyboard Shortcuts</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小結"><span class="toc-number">2.</span> <span class="toc-text">小結</span></a></li></ol></div><ul class="mobile-menu-container"><a href="/" class="mobile-nav-link"><li class="mobile-menu-list"><i class="fa fa-home" aria-hidden="true"></i> 首頁</li></a><a href="/archives" class="mobile-nav-link"><li class="mobile-menu-list"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> 文章</li></a><a href="https://www.facebook.com/liwenzheng.mike" target="_blank" rel="noopener" class="mobile-nav-link"><li class="mobile-menu-list"><i class="fa fa-facebook-official" aria-hidden="true"></i> 臉書</li></a><a href="https://github.com/Mike-Zheng" target="_blank" rel="noopener" class="mobile-nav-link"><li class="mobile-menu-list"><i class="fa fa-github-square" aria-hidden="true"></i> Page</li></a></ul><div class="mobile-side"><div id="authorInfo"><div class="author-logo"></div><section class="author-info"><p>前端工程師的筆記</p></section><div class="social-font"><a href="https://github.com/Mike-Zheng" target="_blank" title="github"></a> <a href="https://www.facebook.com/liwenzheng.mike" target="_blank" title="facebook"></a></div></div><aside class="menu clearfix white-brick"><div class="categorieslist"><p class="asidetitle">Categories</p><ul><a href="/categories/作品/" title="作品"><li><i class="fa fa-folder-o" aria-hidden="true"></i> 作品<sup>16</sup></li></a><a href="/categories/程式筆記/" title="程式筆記"><li><i class="fa fa-folder-o" aria-hidden="true"></i> 程式筆記<sup>12</sup></li></a><a href="/categories/開發筆記/" title="開發筆記"><li><i class="fa fa-folder-o" aria-hidden="true"></i> 開發筆記<sup>3</sup></li></a></ul></div><div class="archiveslist"><p class="asidetitle"><a href="/archives">Archives</a></p><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">1</span></li></ul></div><div class="tagslist"><p class="asidetitle">Tags</p><ul class="clearfix"><a href="/tags/Android/" title="Android"><li><i class="fa fa-tag" aria-hidden="true"></i>Android<sup>1</sup></li></a><a href="/tags/Angularjs/" title="Angularjs"><li><i class="fa fa-tag" aria-hidden="true"></i>Angularjs<sup>2</sup></li></a><a href="/tags/DataMining/" title="DataMining"><li><i class="fa fa-tag" aria-hidden="true"></i>DataMining<sup>1</sup></li></a><a href="/tags/Pokemon/" title="Pokemon"><li><i class="fa fa-tag" aria-hidden="true"></i>Pokemon<sup>1</sup></li></a><a href="/tags/SCSS/" title="SCSS"><li><i class="fa fa-tag" aria-hidden="true"></i>SCSS<sup>2</sup></li></a><a href="/tags/Windows/" title="Windows"><li><i class="fa fa-tag" aria-hidden="true"></i>Windows<sup>1</sup></li></a><a href="/tags/apple-script/" title="apple script"><li><i class="fa fa-tag" aria-hidden="true"></i>apple script<sup>1</sup></li></a><a href="/tags/blog/" title="blog"><li><i class="fa fa-tag" aria-hidden="true"></i>blog<sup>1</sup></li></a><a href="/tags/electron/" title="electron"><li><i class="fa fa-tag" aria-hidden="true"></i>electron<sup>1</sup></li></a><a href="/tags/express-筆記/" title="express 筆記"><li><i class="fa fa-tag" aria-hidden="true"></i>express 筆記<sup>1</sup></li></a><a href="/tags/google-API/" title="google API"><li><i class="fa fa-tag" aria-hidden="true"></i>google API<sup>2</sup></li></a><a href="/tags/gulp/" title="gulp"><li><i class="fa fa-tag" aria-hidden="true"></i>gulp<sup>1</sup></li></a><a href="/tags/jQuery/" title="jQuery"><li><i class="fa fa-tag" aria-hidden="true"></i>jQuery<sup>6</sup></li></a><a href="/tags/mysql-筆記/" title="mysql 筆記"><li><i class="fa fa-tag" aria-hidden="true"></i>mysql 筆記<sup>1</sup></li></a><a href="/tags/node/" title="node"><li><i class="fa fa-tag" aria-hidden="true"></i>node<sup>1</sup></li></a><a href="/tags/node-筆記/" title="node 筆記"><li><i class="fa fa-tag" aria-hidden="true"></i>node 筆記<sup>1</sup></li></a><a href="/tags/npm/" title="npm"><li><i class="fa fa-tag" aria-hidden="true"></i>npm<sup>1</sup></li></a><a href="/tags/npm-筆記/" title="npm 筆記"><li><i class="fa fa-tag" aria-hidden="true"></i>npm 筆記<sup>1</sup></li></a><a href="/tags/openCV/" title="openCV"><li><i class="fa fa-tag" aria-hidden="true"></i>openCV<sup>1</sup></li></a><a href="/tags/pwa/" title="pwa"><li><i class="fa fa-tag" aria-hidden="true"></i>pwa<sup>2</sup></li></a></ul></div></aside></div></nav><div class="overlay"></div><div id="container" class="clearfix miz-container"><div id="main" class="post main col-lg-85 col-md-85 col-xs-12" itemscope itemprop="blogPost"><div class="main-container"><article itemprop="articleBody"><header class="article-info clearfix"><h1 itemprop="name"><a href="/posts/sbuild04/" title="[作品筆記] sketch-builder 雲端原型工具開發筆記(04)  - 功能開發" itemprop="url">[作品筆記] sketch-builder 雲端原型工具開發筆記(04) - 功能開發</a></h1><p class="article-author">By <a href="https://mike-zheng.github.io" title="mikeZheng">mikeZheng</a></p><p class="article-time"><time datetime="2021-07-18T06:30:01.000Z" itemprop="datePublished">2021-07-18</time></p></header><div class="article-content markdown-body"><div id="toc" class="toc-article"><strong class="toc-title">Contents</strong><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#功能開發"><span class="toc-number">1.</span> <span class="toc-text">功能開發</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#需開發的項目"><span class="toc-number">1.1.</span> <span class="toc-text">需開發的項目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#畫布功能"><span class="toc-number">1.2.</span> <span class="toc-text">畫布功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-群組化"><span class="toc-number">1.2.1.</span> <span class="toc-text">1. 群組化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-多選"><span class="toc-number">1.2.2.</span> <span class="toc-text">2. 多選</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-對齊線"><span class="toc-number">1.2.3.</span> <span class="toc-text">3. 對齊線</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-尺規行為"><span class="toc-number">1.2.4.</span> <span class="toc-text">4. 尺規行為</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-縮放"><span class="toc-number">1.2.5.</span> <span class="toc-text">5. 縮放</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-context-menu"><span class="toc-number">1.2.6.</span> <span class="toc-text">6. context menu</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#圖層"><span class="toc-number">1.3.</span> <span class="toc-text">圖層</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#元件"><span class="toc-number">1.4.</span> <span class="toc-text">元件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#export畫布"><span class="toc-number">1.5.</span> <span class="toc-text">export畫布</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Keyboard-Shortcuts"><span class="toc-number">1.6.</span> <span class="toc-text">Keyboard Shortcuts</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小結"><span class="toc-number">2.</span> <span class="toc-text">小結</span></a></li></ol></div><h2 id="功能開發">功能開發</h2><p>這次主題主要是開發原型設計工具，並參考sketch作為主要臨摹對象，在<a href="https://mike-zheng.github.io/sbuild03/">上篇 “(03)開發的目標與介面設計”</a> 已經提到相關UI的設計將會使用印度設計師的作品之後，這一篇要開始嚕一個原型工具出來。</p><p>先簡單列點需要開發的大項目，會再針對各項目進行簡單的探究。<br>更深入的邏輯有興趣的話當然可以pm我本人，不過核心的資料結構操作如果有機會，我是更想要能夠貢獻於目前任職的工作開發項目上面，因此只會列點提示使用的框架與開發的精神。</p><hr><h3 id="需開發的項目">需開發的項目</h3><ol><li><p>畫布核心</p><ol><li>移動 縮放</li><li>多元件選取<ol><li>選取移動</li><li>選取縮放</li><li>選取對齊</li></ol></li><li>對齊線<ol><li>移動對齊線</li><li>同儕對齊線</li><li>縮放對齊線</li></ol></li><li>尺規行為<ol><li>十字線</li><li>拖曳移動</li><li>畫布尺寸</li></ol></li><li>縮放功能<ol><li>各動作的scale運算</li></ol></li><li>context menu</li></ol></li><li><p>圖層</p><ol><li>拖曳移動</li><li>群組間各節點移動</li><li>rename行為</li><li>控制畫布核心行為</li><li>context menu</li></ol></li><li><p>元件</p><ol><li>svg元件</li><li>chart 元件</li></ol></li><li><p>export畫布</p></li><li><p>Keyboard Shortcuts</p></li></ol><h3 id="畫布功能">畫布功能</h3><p>畫布核心主要是fork 老牌的vue拖曳縮放元件: <a href="https://github.com/mauricius/vue-draggable-resizable" target="_blank" rel="noopener">vue-draggable-resizable</a></p><blockquote><p><a href="https://github.com/mauricius/vue-draggable-resizable" target="_blank" rel="noopener">https://github.com/mauricius/vue-draggable-resizable</a></p></blockquote><p>主要他能提供不錯的基底，當然fork下來改造還是花了不少心力，尤其是與其他事件整合上面，例如對齊線與縮放和尺規行為等等。</p><h4 id="1-群組化">1. 群組化</h4><p>主要是參考sketch的資料結構，於<a href="https://mike-zheng.github.io/sbuild02/">第二篇 “(2)sketch資料結構分析”</a> 效法內容裡面的儲存邏輯，不過這邊暫時沒有讓使用者能夠無限群組，對於樹形的遍歷來說，無限制深度的結構會影響蠻多效能的，基於想要提供多選移動及縮放，暫時將節點深度鎖在level 2。</p><h4 id="2-多選">2. 多選</h4><p>多選的核心為<a href="https://simonwep.github.io/selection/" target="_blank" rel="noopener">selectionjs</a></p><p>多選主要就是基於dom操作下的節點運算，每次選擇當下的滑鼠移動，都將進行一次區域的判定。<br>基於多方嘗試後，增加效能的作法就是仰賴dom操作的api evt.target的判定方式，這邊就點到為止。</p><p>多選的功能加入後，理應當支援的就是多選後的縮放，移動與對齊。</p><p>縮放與移動是類似的行為，多個同儕的dom節點不支援拖曳功能，你想要進行滑鼠的運作是不可能的。<br>當然這句話有例外:</p><blockquote><p>參考文件 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API/Multiple_items" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API/Multiple_items</a></p></blockquote><p>但…只有基於Gecko的Mozilla Firefox支援multi drag api，我們開發總不能讓大部分的瀏覽器都不能用吧…。</p><p>所以這條路當然是不通的。</p><p>換句話說，如果你想要一次移動多個節點，但你只能針對一個節點進行移動，這不就代表你要用一個來表示全部的節點嗎?<br>朝這個思路進行解決多選的行為就簡單了</p><ol><li>選取後建立虛擬節點壓在全部節點之上</li><li>動態計算其boundary</li><li>移動或縮放虛擬節點將一併運算各個選取的節點</li></ol><p>這樣就大致完成多選移動縮放的邏輯。</p><h4 id="3-對齊線">3. 對齊線</h4><p>簡單來說就是將吸附功能做進去，並顯示出來</p><pre class="language-js"><code class="language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span> comp <span class="token keyword">in</span> allComps<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> deltaXY <span class="token operator"><=</span> tolerant <span class="token punctuation">)</span>
        newXY <span class="token operator">=</span> compXY
</code></pre><p>類似這樣的邏輯思路。<br>不過困難點會在於需要實現不同的對齊線吸附</p><ol><li>移動對齊線</li><li>同儕對齊線</li><li>縮放對齊線</li></ol><h4 id="4-尺規行為">4. 尺規行為</h4><p>這邊主要參考 react ruler 的vue版本</p><blockquote><p><a href="https://github.com/daybrush/ruler/tree/master/packages/react-ruler" target="_blank" rel="noopener">https://github.com/daybrush/ruler/tree/master/packages/react-ruler</a><br><a href="https://github.com/daybrush/ruler/tree/master/packages/vue-ruler" target="_blank" rel="noopener">https://github.com/daybrush/ruler/tree/master/packages/vue-ruler</a></p></blockquote><p>而十字線部分關於dom效能的運作 這一篇給了很好的思路</p><blockquote><p><a href="https://stackoverflow.com/questions/20060691/most-modern-method-of-getting-mouse-position-within-a-canvas-in-native-javascrip" target="_blank" rel="noopener">https://stackoverflow.com/questions/20060691/most-modern-method-of-getting-mouse-position-within-a-canvas-in-native-javascrip</a></p></blockquote><p>因此實作主要使用</p><pre class="language-js"><code class="language-js">target<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>api進行Dimension的取得。</p><h4 id="5-縮放">5. 縮放</h4><p>縮放其實沒有什麼特別的，就是算數學。但在實作上 對於任何的dom dimension運算都要額外進行scale的運算，因此基於DRY原則(Don’t repeat yourself)下，如何將結構寫好才是需要注意的地方。<br>主畫面的縮放使用<code>transform: scale(${this.scale})</code></p><h4 id="6-context-menu">6. context menu</h4><p>context menu 我自己是覺得是web與應用程式的差異中微妙的界線，當web上面支援context menu的使用，才能說自己是應用程式(我自己的認為啦…)。</p><img src="01.png" alt="context menu" style="width:360px"><p>這邊是fork <code>v-contextmenu</code> 進行二次開發</p><blockquote><p><a href="https://github.com/heynext/v-contextmenu" target="_blank" rel="noopener">https://github.com/heynext/v-contextmenu</a><br>裡面的功能主要就是store 資料流的操作。</p></blockquote><h3 id="圖層">圖層</h3><p>fork <code>vue-tree-list</code> 與 <code>v-contextmenu</code> 進行二次開發</p><blockquote><p><a href="https://github.com/ParadeTo/vue-tree-list" target="_blank" rel="noopener">https://github.com/ParadeTo/vue-tree-list</a><br><a href="https://github.com/heynext/v-contextmenu" target="_blank" rel="noopener">https://github.com/heynext/v-contextmenu</a></p></blockquote><p>這邊的功能其實就是一個很完整的大功能了，目前完成的部分還有很多feature可以添加，礙於版本篇幅就先用相對簡單的處理完成第一版本。</p><p>此版本主要提供功能為</p><ol><li>拖曳移動</li><li>群組間各節點移動</li><li>rename行為</li><li>控制畫布核心行為</li><li>context menu</li></ol><h3 id="元件">元件</h3><p>元件的部分目前僅有提供</p><ol><li>svg元件</li><li>chart 元件</li></ol><p>chart 是apache基金會的echart</p><blockquote><p><a href="https://echarts.apache.org/examples/zh/editor.html" target="_blank" rel="noopener">https://echarts.apache.org/examples/zh/editor.html</a></p></blockquote><h3 id="export畫布">export畫布</h3><blockquote><p><a href="https://github.com/tsayen/dom-to-image" target="_blank" rel="noopener">https://github.com/tsayen/dom-to-image</a></p></blockquote><h3 id="Keyboard-Shortcuts">Keyboard Shortcuts</h3><p>提供</p><ul><li>ctrl+] 移到上一層</li><li>ctrl+shift+] 移到最上層</li><li>ctrl+[ 移到下一層</li><li>ctrl+shift+[ 移到最下層</li><li>ctrl+c 複製</li><li>ctrl+v 貼上</li><li>ctrl+g 組成群組</li><li>ctrl+shift+g 解散群組</li><li>ctrl+h 隱藏</li><li>ctrl+shift+h 顯示</li><li>delete 刪除</li><li>ctrl+z 復原</li><li>ctrl+y 重作</li><li>space+mouse pan 畫布移動</li></ul><h2 id="小結">小結</h2><p>整體的資料結構邏輯來說，都與畫布核心的連動關係有關，因此開發途中會遇到一職需要重新封裝的狀態，最後索性都丟給store去處理。<br>都給store去處理的好處就是各封裝元件只有需要專心處理自己的prop就好，其他部分就trigger一個action請store去重新運算。</p><p>簡單開發的筆記就寫到這邊，未來如果功能持續更新再來跟大家分享。</p><p>陸續更新:<br><strong>sketch-builder 雲端原型工具:</strong><br><a href="https://mike-zheng.github.io/sketch-builder">https://mike-zheng.github.io/sketch-builder</a></p><hr><p>雲端原型工具開發筆記系列文</p><ul><li><p><a href="https://mike-zheng.github.io/sbuild01/">[作品筆記] sketch-builder 雲端原型工具開發筆記(01) - 前端應用軟體領域技術的探索</a></p></li><li><p><a href="https://mike-zheng.github.io/sbuild02/">[作品筆記] sketch-builder 雲端原型工具開發筆記(02) - sketch資料結構分析</a></p></li><li><p><a href="https://mike-zheng.github.io/sbuild03/">[作品筆記] sketch-builder 雲端原型工具開發筆記(03) - 開發的目標與介面設計</a></p></li><li><p><a href="https://mike-zheng.github.io/sbuild05/">[作品筆記] sketch-builder 雲端原型工具開發筆記(05) - Beta1.0 功能展示</a></p></li></ul></div><footer class="article-footer clearfix"><div class="article-tags"><span></span> <span class="tag"><a href="/tags/專案/" class="article-tag">專案</a></span></div><div class="article-categories"><span></span> <a class="article-category category-tag-link" href="/categories/%E4%BD%9C%E5%93%81/">作品<span class="article-category category-tag-count">16</span></a></div><div class="article-share" id="share"><div class="jiathis_style"><span class="jiathis_txt">分享到：</span> <a class="jiathis_button_fb">Facebook </a><a class="jiathis_button_googleplus">google+ </a><a class="jiathis_button_twitter">Twitter</a></div><script type="text/javascript">var jiathis_config={data_track_clickback:!0,sm:"copy,renren,cqq",pic:"",summary:""}</script><script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=
2119983" charset="utf-8"></script></div></footer></article><nav class="article-nav clearfix"><div class="prev"><a href="/posts/sbuild05/" title="[作品筆記] sketch-builder 雲端原型工具開發筆記(05) - Beta1.0 功能展示"><strong>PREVIOUS:</strong><br><span>[作品筆記] sketch-builder 雲端原型工具開發筆記(05) - Beta1.0 功能展示</span></a></div><div class="next"><a href="/posts/sbuild03/" title="[作品筆記] sketch-builder 雲端原型工具開發筆記(03)  - 開發的目標與介面設計"><strong>NEXT:</strong><br><span>[作品筆記] sketch-builder 雲端原型工具開發筆記(03) - 開發的目標與介面設計</span></a></div></nav><section id="comment"><h1 class="title">Comments</h1><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></div></div><div id="asidepart" class="col-lg-15 col-md-15 col-xs-12 hidden-xs hidden-sm"><div id="authorInfo"><div class="author-logo"></div><section class="author-info"><p>前端工程師的筆記</p></section><div class="social-font"><a href="https://github.com/Mike-Zheng" target="_blank" title="github"></a> <a href="https://www.facebook.com/liwenzheng.mike" target="_blank" title="facebook"></a></div></div><aside class="menu clearfix white-brick"><div class="categorieslist"><p class="asidetitle">Categories</p><ul><a href="/categories/作品/" title="作品"><li><i class="fa fa-folder-o" aria-hidden="true"></i> 作品<sup>16</sup></li></a><a href="/categories/程式筆記/" title="程式筆記"><li><i class="fa fa-folder-o" aria-hidden="true"></i> 程式筆記<sup>12</sup></li></a><a href="/categories/開發筆記/" title="開發筆記"><li><i class="fa fa-folder-o" aria-hidden="true"></i> 開發筆記<sup>3</sup></li></a></ul></div><div class="archiveslist"><p class="asidetitle"><a href="/archives">Archives</a></p><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">1</span></li></ul></div><div class="tagslist"><p class="asidetitle">Tags</p><ul class="clearfix"><a href="/tags/Android/" title="Android"><li><i class="fa fa-tag" aria-hidden="true"></i>Android<sup>1</sup></li></a><a href="/tags/Angularjs/" title="Angularjs"><li><i class="fa fa-tag" aria-hidden="true"></i>Angularjs<sup>2</sup></li></a><a href="/tags/DataMining/" title="DataMining"><li><i class="fa fa-tag" aria-hidden="true"></i>DataMining<sup>1</sup></li></a><a href="/tags/Pokemon/" title="Pokemon"><li><i class="fa fa-tag" aria-hidden="true"></i>Pokemon<sup>1</sup></li></a><a href="/tags/SCSS/" title="SCSS"><li><i class="fa fa-tag" aria-hidden="true"></i>SCSS<sup>2</sup></li></a><a href="/tags/Windows/" title="Windows"><li><i class="fa fa-tag" aria-hidden="true"></i>Windows<sup>1</sup></li></a><a href="/tags/apple-script/" title="apple script"><li><i class="fa fa-tag" aria-hidden="true"></i>apple script<sup>1</sup></li></a><a href="/tags/blog/" title="blog"><li><i class="fa fa-tag" aria-hidden="true"></i>blog<sup>1</sup></li></a><a href="/tags/electron/" title="electron"><li><i class="fa fa-tag" aria-hidden="true"></i>electron<sup>1</sup></li></a><a href="/tags/express-筆記/" title="express 筆記"><li><i class="fa fa-tag" aria-hidden="true"></i>express 筆記<sup>1</sup></li></a><a href="/tags/google-API/" title="google API"><li><i class="fa fa-tag" aria-hidden="true"></i>google API<sup>2</sup></li></a><a href="/tags/gulp/" title="gulp"><li><i class="fa fa-tag" aria-hidden="true"></i>gulp<sup>1</sup></li></a><a href="/tags/jQuery/" title="jQuery"><li><i class="fa fa-tag" aria-hidden="true"></i>jQuery<sup>6</sup></li></a><a href="/tags/mysql-筆記/" title="mysql 筆記"><li><i class="fa fa-tag" aria-hidden="true"></i>mysql 筆記<sup>1</sup></li></a><a href="/tags/node/" title="node"><li><i class="fa fa-tag" aria-hidden="true"></i>node<sup>1</sup></li></a><a href="/tags/node-筆記/" title="node 筆記"><li><i class="fa fa-tag" aria-hidden="true"></i>node 筆記<sup>1</sup></li></a><a href="/tags/npm/" title="npm"><li><i class="fa fa-tag" aria-hidden="true"></i>npm<sup>1</sup></li></a><a href="/tags/npm-筆記/" title="npm 筆記"><li><i class="fa fa-tag" aria-hidden="true"></i>npm 筆記<sup>1</sup></li></a><a href="/tags/openCV/" title="openCV"><li><i class="fa fa-tag" aria-hidden="true"></i>openCV<sup>1</sup></li></a><a href="/tags/pwa/" title="pwa"><li><i class="fa fa-tag" aria-hidden="true"></i>pwa<sup>2</sup></li></a></ul></div></aside><div id="adsense" class="white-brick adsense-wrapper"><script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-2187797826115869",enable_page_level_ads:!0})</script></div></div></div><footer><footer id="footer"></footer></footer><script type="text/javascript" defer>var disqus_shortname="mikezheng";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script type="text/javascript" defer></script><link rel="stylesheet" href="/fancybox/jquery.fancybox-1.3.4.css" media="screen" type="text/css"><script type="text/javascript" defer>$(document).ready(function(){$(".article-content").each(function(a){$(this).find("img").each(function(){var a=this.alt;a&&$(this).after('<span class="caption">'+a+"</span>"),$(this).wrap('<a href="'+this.src+'" title="'+a+'" class="fancybox"></a>')}),$(this).find(".fancybox").each(function(){$(this).attr("rel","article"+a)})}),$.fancybox&&$(".fancybox").fancybox()})</script><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js?t=1645886555915").then(function(){console.log("ServiceWorker Register Successfully.")}).catch(function(e){console.error(e)})</script><script type="text/javascript" src="/js/mizUI.js"></script></body></html>